

{% extends 'testapp/index.html' %}

{% block content %}




<div class="container" style="width: 70%; ">
    <div class="card shadow-grey border-10 rounded-lg mt-4" style="padding: 5px;background:linear-gradient(135deg,#71b7e6,#9b59b6);">
      <div class="card-header" style="background-color:#eff5fa"><h3 class="text-center font-weight-light my-4">Employee</h3></div><br>
  <form method="POST" action="{% url 'addemp' %}">
    {% csrf_token %}
   
       <div class="row">
          <div class="col-md-6">
              <div class="form-group mb-3">
                  <label for="employee_id" class="control-label">Employee ID</label>
                  <input type="text" name="employee_id" id="employee_id" class="form-control form-control-sm rounded-0" style="text-transform:uppercase" required>
                  
              </div>
              <div class="form-group mb-3">
                  <label for="firstname" class="control-label">First Name</label>
                  <input type="text" name="firstname" id="firstname" class="form-control form-control-sm rounded-0" style="text-transform:uppercase" required>
                  
              </div>
              
              <div class="form-group mb-3">
                  <label for="middlename" class="control-label">Middle Name</label>
                  <input type="text" name="middlename" id="middlename" style="text-transform:uppercase" class="form-control form-control-sm rounded-0">
              </div>
              <div class="form-group mb-3">
                  <label for="lastname" class="control-label">Last Name</label>
                  <input type="text" name="lastname" id="lastname" style="text-transform:uppercase" class="form-control form-control-sm rounded-0" required>
              </div>
              
              <!-- <div class="form-group mb-3">
                <label for="gender " class="control-label">gender</label>
                <input type="gender" name="gender" id="gender" class="form-control form-control-sm rounded-0" required>
            </div> -->

            <div class="form-group mb-3">
                <label>Gender</label>
                <select name="gender" class="selectpicker" data-title="Select Gender" data-style="btn-default btn-block" data-menu-style="dropdown-blue" required>
                {% for x,y in form.fields.gender.choices %}
                   <option value="{{ x }}"{% if form.fields.gender.value == x %} selected{% endif %}>{{ y }}</option>
                {% endfor %}
                </select>
            </div>



              <div class="form-group mb-3">
                  <label for="dob" class="control-label">Birthday</label>
                  <input type="date" name="dob" id="dob" class="form-control form-control-sm rounded-0" required>
              </div>
              <div class="form-group mb-3">
                  <label for="pan_no" class="control-label">PAN NO</label>
                  <input type="text" name="pan_no" id="pan_no" class="form-control form-control-sm rounded-0" style="text-transform:uppercase" required>
              </div>
              <div class="form-group mb-3">
                  <label for="email" class="control-label">Email</label>
                  <input type="email" name="email" id="email" class="form-control form-control-sm rounded-0" required><span style="color: red;"></span>
                  <span id="msg"></span>
              </div>
              <div class="form-group mb-3">
                  <label for="contact" class="control-label">Contact #</label>
                  <input type="number" name="contact" id="contact" class="form-control form-control-sm rounded-0" required>
              </div>
              <div class="form-group mb-3">
                  <label for="address" class="control-label">Address</label>
                  <textarea rows="3" name="address" id="address" class="form-control form-control-sm rounded-0" required></textarea>
              </div>
          </div>
          <div class="col-md-6">
            <div class="form-group mb-3">
              <label for="company_name" class="control-label">Company</label>
              <select name="company_name" id="company_name" class="form-select form-select-sm rounded-0" required>
                
                  <option value="1" disabled selected required>Please Select Company</option>
                
                  {% for comp in company %}
                      {% if employee.company_name and employee.company_name == comp.id %}
                      <option value="{{ comp.id }}" selected>{{ comp.cname }}</option>
                      {% else %}
                      <option value="{{ comp.id }}">{{ comp.cname }}</option>
                      {% endif %}
                  {% endfor %}
  
              </select>
          </div>
          
              <div class="form-group mb-3">
                  <label for="department_name" class="control-label">Department</label>
                  <select name="department_name" id="department_name" class="form-select form-select-sm rounded-0" required>
                    
                      <option value="1" disabled selected>Please Select Department</option>
                    
                      {% for department in departments %}
                          {% if employee.department_name and employee.department_name == department.id %}
                          <option value="{{ department.id }}" selected>{{ department.name }}</option>
                          {% else %}
                          <option value="{{ department.id }}">{{ department.name }}</option>
                          {% endif %}
                      {% endfor %}

                  </select>
              </div>
              <div class="form-group mb-3">
                  <label for="position_id" class="control-label">Position</label>
                  <select name="position_id" id="position_id" class="form-select form-select-sm rounded-0" required>
                     
                      <option value="1" disabled selected>Please Select Position</option>
                      
                      {% for position in positions %}
                          {% if employee.position_id and employee.position_id == position.id %}
                          <option value="{{ position.id }}" selected>{{ position.pname }}</option>
                          {% else %}
                          <option value="{{ position.id }}">{{ position.pname }}</option>
                          {% endif %}
                      {% endfor %}

                  </select>
              </div>
              <div class="form-group mb-3">
                  <label for="offer_date" class="control-label">Offer-Date</label>
                  <input type="date" name="offer_date" class="form-control form-control-sm rounded-0" required>
              </div>
              <div class="form-group mb-3">
                  <label for="date_hired" class="control-label">joining-Date</label>
                  <input type="date" name="joining_date" class="form-control form-control-sm rounded-0" required>
              </div>
              <div class="form-group mb-3">
                  <label for="salary" class="control-label">package</label>
                  <input type="number" step="any" name="package" class="form-control form-control-sm rounded-0" required>
              </div>
              <button type="submit" class="btn btn-success" href="{% url 'employee' %}">ADD</button>
              <button type="reset" class="btn btn-danger">Reset</button>

              </div>
          </div>
      </div>  
  </form>
</div>
</div>
</div>
{% endblock %}

{% block footer_scripts %}
        

<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
<script>
  $("#email").change(function () {
    var email = $(this).val();

    $.ajax({
      url: '/validate_email/',
      data: {
        'email': email
      },
      dataType: 'json',
      success: function (data) {
        if (data.is_taken) {
          $("#msg").css({"color":"red"});
               $("#msg").html("This  already exists");
               $('#email').focus();
               $("#email").val(""); 
        }
        else
               {
               $("#msg").css({"color":"green"});
               $("#msg").html("this is available !"); 
               }
      }
    });

  });
</script>

{% endblock %}


